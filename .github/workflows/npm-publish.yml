name: Publish npm packages

on:
  workflow_dispatch:
    inputs:
      release_type:
        description: 'Type of publish (one of: rc, main, both, hotfix)'
        required: true
        default: 'rc'
      branch:
        description: 'Hotfix branch'
        required: false

jobs:
  both:
    name: Publish release/RC
    if: ${{ github.event.inputs.release_type == 'both' }}
    uses: ./.github/workflows/reusable-release-both.yml
    secrets: inherit

  main:
    name: Publish release
    if: ${{ github.event.inputs.release_type == 'main' }}
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: main
    secrets: inherit

  rc:
    name: Publish RC
    if: ${{ github.event.inputs.release_type == 'rc' }}
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: rc
    secrets: inherit

  hotfix:
    name: Publish hotfix
    if: ${{ github.event.inputs.release_type == 'hotfix' }}
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: hotfix
      branch: ${{ github.event.inputs.branch }}
    secrets: inherit
