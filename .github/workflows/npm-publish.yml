name: Publish npm packages

on:
  workflow_dispatch:
    inputs:
      release_type:
        description: 'Type of publish (one of: rc, main, both, hotfix)'
        required: true
        default: 'rc'
      branch:
        description: 'Hotfix branch'
        required: false

jobs:
  publish_main:
    name: Publish release
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: main
    secrets: inherit

  publish_rc:
    name: Publish RC
    needs: publish_main
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: rc
    secrets: inherit

  publish_hotfix:
    name: Publish hotfix
    uses: ./.github/workflows/reusable-release.yml
    with:
      release_type: hotfix
      branch: ${{ github.event.inputs.branch }}
    secrets: inherit
